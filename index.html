<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login OTP</title>
<link rel="icon" href="https://cdn-icons-png.flaticon.com/512/1828/1828490.png">
<style>
body{
    margin:0;
    height:100vh;
    font-family:Arial,Helvetica,sans-serif;
    background:linear-gradient(135deg,#1e3c72,#2a5298);
    display:flex;
    justify-content:center;
    align-items:center;
    color:white;
}
.box{
    background:rgba(0,0,0,.35);
    padding:40px;
    border-radius:15px;
    text-align:center;
    width:320px;
    box-shadow:0 0 25px rgba(0,0,0,.5);
}
input{
    margin-top:20px;
    padding:12px;
    width:100%;
    border-radius:8px;
    border:none;
    font-size:16px;
}
footer{
    margin-top:20px;
    font-size:12px;
    opacity:.7;
}
</style>
</head>

<body>

<div class="box">
    <h1>Login bằng OTP</h1>
    <p>Nhập email để nhận mã xác minh</p>

    <input type="email" id="email" placeholder="Nhập email rồi bấm Enter">
    <div id="otpArea"></div>

    <footer>© 2026 THKhoa109-Droid</footer>
</div>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function(){

emailjs.init("jZNFpiP6_5wtr0yql");

const SERVICE_ID = "service_qqug51j";
const TEMPLATE_ID = "template_skla7hm";
const NEXT_PAGE = "https://thkhoa109-droid.github.io/MRprogamSKSDownloads/";

let generatedOTP = "";
let otpSent = false;

function generateOTP(){
    return Math.floor(100000 + Math.random() * 900000).toString();
}

const emailInput = document.getElementById("email");
const otpArea = document.getElementById("otpArea");

/* ===== GỬI OTP ===== */
emailInput.addEventListener("keydown", function(e){
    if(e.key === "Enter"){

        if(otpSent) return;

        if(emailInput.value.trim() === ""){
            alert("Vui lòng nhập email!");
            return;
        }

        generatedOTP = generateOTP();
        otpSent = true;

        emailjs.send(SERVICE_ID, TEMPLATE_ID, {
            to_email: emailInput.value,
            otp_code: generatedOTP
        }).then(function(){

            alert("Đã gửi OTP về email!");
            showOTPInput();

        }).catch(function(error){
            alert("Gửi email thất bại!");
            otpSent = false;
            console.log(error);
        });
    }
});

/* ===== NHẬP OTP ===== */
function showOTPInput(){

    emailInput.disabled = true;

    const otpInput = document.createElement("input");
    otpInput.type = "text";
    otpInput.placeholder = "Nhập mã OTP rồi bấm Enter";
    otpArea.appendChild(otpInput);

    otpInput.focus();

    otpInput.addEventListener("keydown", function(e){
        if(e.key === "Enter"){

            if(otpInput.value === generatedOTP){
                alert("Xác minh thành công!");
                window.location.href = NEXT_PAGE;
            } else {
                alert("Sai mã OTP!");
            }
        }
    });
}
/* ===== BLOCK DEVTOOLS PC ===== */ document.addEventListener("contextmenu",e=>e.preventDefault()); document.addEventListener("keydown",e=>{ if( e.key==="F12" || (e.ctrlKey && e.shiftKey) || (e.ctrlKey && e.key==="U") ){ e.preventDefault(); e.stopPropagation(); return false; } }); /* ===== BLOCK DEVTOOLS MOBILE ===== */ document.addEventListener("touchstart",e=>{ if(e.touches.length>1) e.preventDefault(); },{passive:false}); document.addEventListener("gesturestart",e=>e.preventDefault()); setInterval(()=>{ if( window.outerWidth-window.innerWidth>160 || window.outerHeight-window.innerHeight>160 ){ document.body.innerHTML = "<h1 style='text-align:center;margin-top:40vh'>⚠️ DevTools bị phát hiện</h1>"; } },700);
});
</script>

</body>
</html>
